<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Plato - public/javascripts/load_dhtmlx_project_tree.js</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">

  <!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <link href="../../assets/css/vendor/morris.css" rel="stylesheet">
  <link href="../../assets/css/vendor/bootstrap.css" rel="stylesheet">
  <link href="../../assets/css/vendor/font-awesome.css" rel="stylesheet">
  <link href="../../assets/css/vendor/codemirror.css" rel="stylesheet">
  <link href="../../assets/css/plato.css" rel="stylesheet">
  <link href="../../assets/css/plato-file.css" rel="stylesheet">

</head>

<body>

<div class="navbar navbar-fixed-top">
  <div class="container">
    <a class="navbar-brand" href="http://github.com/es-analysis/plato">Plato on Github</a>
    <ul class="nav navbar-nav">
      <li>
        <a href="../../index.html">Report Home</a>
      </li>
    </ul>
  </div>
</div>

<div class="jumbotron">
  <div class="container">
    <h1>public/javascripts/load_dhtmlx_project_tree.js</h1>
  </div>
</div>

<div class="container aggregate-stats">
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Maintainability <a href="http://blogs.msdn.com/b/codeanalysis/archive/2007/11/20/maintainability-index-range-and-meaning.aspx"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="A value between 0 and 100 that represents the relative ease of maintaining the code. A high value means better maintainability." data-original-title="Maintainability Index"  data-container="body"></i></a></h2>
      <p class="stat">64.59</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Lines of code <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h2>
      <p class="stat">446</p>
    </div>
  </div>
  <div class="row historical">
    <div class="col-md-6">
      <p id="chart_historical_maint" class="chart"></p>
    </div>
    <div class="col-md-6">
      <p id="chart_historical_sloc" class="chart"></p>
    </div>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Difficulty  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="The difficulty measure is related to the difficulty of the program to write or understand." data-original-title="Difficulty" data-container="body"></i></a></h2>
      <p class="stat">65.02</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Estimated Errors  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Halstead's delivered bugs is an estimate for the number of errors in the implementation." data-original-title="Delivered Bugs" data-container="body"></i></a></h2>
      <p class="stat">4.07</p>
    </div>
  </div>
</div>

<div class="container charts">
  <div class="row">
    <h2 class="header">Function weight</h2>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h3 class="chart-header">By Complexity <a href="http://en.wikipedia.org/wiki/Cyclomatic_complexity"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="This metric counts the number of distinct paths through a block of code. Lower values are better." data-original-title="Cyclomatic Complexity" data-container="body"></i></a></h3>
      <div id="fn-by-complexity" class="stat"></div>
    </div>
    <div class="col-md-6">
      <h3 class="chart-header">By SLOC  <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h3>
      <div id="fn-by-sloc" class="stat"></div>
    </div>
  </div>
</div>

<div class="container">
  <div class="row">
    <textarea id="file-source" class="col-md-12">var ds_count = 0;
var clear_filters_btn_id = document.getElementById(&#039;clear_filters_btn_id&#039;);
if (typeof clear_filters_btn_id !== &#039;undefined&#039;) {
  clear_filters_btn_id.addEventListener(&#039;click&#039;, function () {
      clear_filters();
  });
}

var env_source_select = document.getElementById(&#039;env_source_select&#039;);
if (typeof env_source_select !== &#039;undefined&#039;) {
  env_source_select.addEventListener(&#039;change&#039;, function () {
      filter_by_env();
  });
}

var target_select = document.getElementById(&#039;target_select&#039;);
if (typeof target_select !== &#039;undefined&#039;) {
  target_select.addEventListener(&#039;change&#039;, function () {
      filter_by_target()
  });
}
var portal_select = document.getElementById(&#039;portal_select&#039;) || null;
if (portal_select !== null) {
  portal_select.addEventListener(&#039;change&#039;, function () {
      filter_by_portal()
  });
}
var pub_priv = document.getElementsByName(&#039;pub_priv&#039;);
if (typeof pub_priv[0] !== &#039;undefined&#039;) {
  pub_priv[0].addEventListener(&#039;click&#039;, function () {
      filter_by_status(1)
  });
  pub_priv[1].addEventListener(&#039;click&#039;, function () {
      filter_by_status(0)
  });
}
var metadata_select = document.getElementById(&#039;metadata_select&#039;);
if (typeof metadata_select !== &#039;undefined&#039;) {
  metadata_select.addEventListener(&#039;change&#039;, function () {
      filter_by_metadata()
  });
}
function initialize_dhtmlx_project_tree() {
    // http://docs.dhtmlx.com/tree__index.html
    projectTree = new dhtmlXTreeObject(&quot;projects_select_div&quot;,&quot;100%&quot;,&quot;100%&quot;,0);
    projectTree.setImagesPath(&quot;/images/dhtmlx/imgs/&quot;);
    projectTree.enableCheckBoxes(true);
    
    //projectTree.enableTreeLines(true); // true by default
    projectTree.enableTreeImages(false);
    projectTree.attachEvent(&quot;onCheck&quot;,function(id){
      on_check_dhtmlx(id)
    });
    projectTree.attachEvent(&quot;onDblClick&quot;, function(id){
      expand_tree_dhtmlx(id)
    });
    projectTree.attachEvent(&quot;onOpenEnd&quot;,onNodeSelect);
    projectTree.setXMLAutoLoading(&quot;/visuals/project_dataset_tree_dhtmlx&quot;);
    projectTree.setDataMode(&quot;json&quot;);

	// MOVED TO CLEAR FILTERS:: loads first level of tree
	//projectTree.load(&quot;/visuals/project_dataset_tree_dhtmlx?id=0&quot;,&quot;json&quot;);
    
}
//
//
//
  // function load_projects_only_tree(){
    
  //   var xmlhttp = new XMLHttpRequest();  
  //   xmlhttp.open(&quot;GET&quot;, &#039;get_projects_only_tree&#039;, true);
  //   xmlhttp.setRequestHeader(&quot;Content-type&quot;,&quot;application/x-www-form-urlencoded&quot;);
  //   xmlhttp.onreadystatechange=function() {
  //     if (xmlhttp.readyState==4 ) {
  //         html = xmlhttp.responseText;
  //         document.getElementById(&#039;projects_only_select_div&#039;).innerHTML=html;

          
          
  //     }
  //   }
  //   xmlhttp.send();
  // }
//
//
//
function set_dataset_count(id){
    
    var checked_nodes = projectTree.getAllChecked().split(&#039;,&#039;)
    var count = 0
    for(i in checked_nodes){
        // only count datasets
        if(projectTree.getLevel(checked_nodes[i]) === 2){
            count += 1
        }
    }
    document.getElementById(&#039;selected_ds_count_id&#039;).innerHTML = count
}
//
//
//
function onNodeSelect(id){
    
    var openState = projectTree.getOpenState(id);
    if(openState &lt; 1){
        // un-select all on close node
        projectTree.setSubChecked(id, false)
    }else{
        projectTree.setSubChecked(id, true)
        projectTree.setCheck(id,false); 
    }
    set_dataset_count(id)
}
//
//
//
function on_check_dhtmlx(id){
        
    var level = projectTree.getLevel(id)
    
    if(level === 1){
        // project
        projectTree.openItem(id);
        projectTree.setCheck(id,false);  
        var openState = projectTree.getOpenState(id);
        if(openState === 1){
            dids = projectTree.getAllSubItems(id);
            didArray = dids.split(&#039;,&#039;);
            var checkStateZero = projectTree.isItemChecked(didArray[0]);
            if(checkStateZero  === 1){
                //checked
                projectTree.setSubChecked(id, false);
            }else{
                //not checked
                projectTree.setSubChecked(id, true);
                projectTree.setCheck(id,false); 
            }
        }else{
            
        }
    }else{
        // dataset

    }
    set_dataset_count(id)
}
//
//
//
function expand_tree_dhtmlx(id){
    //alert(&#039;expand&#039;)
    on_check_dhtmlx(id)
}
//
// CLEAR FILTERS
////////////////////////////////////////////
function clear_filters() {
  // used to clear all search filters and upon intial load
  
  var filtering = 0; 
  var datasets_local = {}; 
  if(portal_local){
    var target = &quot;/visuals/load_portal/&quot;+portal_local;
  }else{
    var target = &quot;/visuals/clear_filters&quot;;
  }
  document.getElementById(&#039;target_select&#039;).value=&#039;.....&#039;;
  document.getElementById(&#039;metadata_select&#039;).value=&#039;.....&#039;;
  document.getElementById(&#039;env_source_select&#039;).value=&#039;.....&#039;;
  document.getElementById(&#039;pname_search_id&#039;).value=&#039;&#039;;
  document.getElementById(&#039;status_pub&#039;).checked=0;
  document.getElementById(&#039;status_priv&#039;).checked=0;
  if(document.getElementById(&#039;portal_select&#039;)){
    document.getElementById(&#039;portal_select&#039;).value =&#039;.....&#039;
  }
  var xmlhttp = new XMLHttpRequest();
  //alert(xmlhttp)  
  xmlhttp.open(&quot;GET&quot;, target, true);
  xmlhttp.setRequestHeader(&quot;Content-type&quot;,&quot;application/json&quot;);
  xmlhttp.onreadystatechange=function() {
    if ( xmlhttp.readyState == 4 ) {
        pcount = xmlhttp.responseText;
        //alert(pcount)
        if( pcount === 0 ){
            document.getElementById(&#039;nodata_span&#039;).innerHTML=&#039;No Projects Found&#039;;
        }else{
            document.getElementById(&#039;nodata_span&#039;).innerHTML=&#039;&#039;;
        }
        
        document.getElementById(&quot;project_count_id&quot;).innerHTML = xmlhttp.responseText;
        
        document.getElementById(&#039;selected_ds_count_id&#039;).innerHTML = 0
        
        projectTree.deleteChildItems(0);
        //load initial
        
        //projectTree.load(&quot;/visuals/project_dataset_tree_dhtmlx?id=0&quot;,&quot;json&quot;); 
        projectTree.load(&quot;/visuals/project_dataset_tree_dhtmlx?id=0&quot;,afterCall,&quot;json&quot;); 
    
    }
  }
  xmlhttp.send();
}
//
//  SHOW/FILTER  RESULTS for project/substring Search
//
function afterCall(){
  
    var delay=100; //0.1 second
    setTimeout(function() {
        //your code to be executed after 0.1 second
        set_dataset_count(0)
    }, delay);
}
function showLiveProjectNames(str) {
  var filtering = 1;
  var datasets_local = {};
  if (str.length==0) {
    str = &#039;----&#039;;  // cannot be empty string : (hopefully no-one will search for this)
  }
  document.getElementById(&#039;env_source_select&#039;).value=&#039;.....&#039;;
  document.getElementById(&#039;metadata_select&#039;).value=&#039;.....&#039;;
  document.getElementById(&#039;target_select&#039;).value=&#039;.....&#039;;
  document.getElementById(&#039;status_pub&#039;).checked=0;
  document.getElementById(&#039;status_priv&#039;).checked=0;
  if(document.getElementById(&#039;portal_select&#039;)){
    document.getElementById(&#039;portal_select&#039;).value =&#039;.....&#039;
  }
  if(portal_local){
    var target = &quot;/visuals/livesearch_projects/&quot;+str+&#039;?portal=&#039;+portal_local;
  }else{
    var target = &quot;/visuals/livesearch_projects/&quot;+str;
  }
  var xmlhttp = new XMLHttpRequest();  
  xmlhttp.open(&quot;GET&quot;, target, true);
  xmlhttp.setRequestHeader(&quot;Content-type&quot;,&quot;application/x-www-form-urlencoded&quot;);
  xmlhttp.onreadystatechange=function() {
    if ( xmlhttp.readyState == 4 ) {
        pcount = xmlhttp.responseText;
        if( pcount == 0 ){
            document.getElementById(&#039;nodata_span&#039;).innerHTML=&#039;No Projects Found&#039;;
        }else{
            document.getElementById(&#039;nodata_span&#039;).innerHTML=&#039;&#039;;
        }
      document.getElementById(&quot;project_count_id&quot;).innerHTML = pcount;
      document.getElementById(&#039;selected_ds_count_id&#039;).innerHTML = 0
      projectTree.deleteChildItems(0);
      projectTree.load(&quot;/visuals/project_dataset_tree_dhtmlx?id=0&quot;,afterCall,&quot;json&quot;);     
    }
  }
  xmlhttp.send();
}
//
//  SHOW/FILTER  RESULTS for environmental source Search
//
function filter_by_env() {
  var filtering = 1;
  var datasets_local = {};
  var env_source_id =  document.getElementById(&#039;env_source_select&#039;).value;
  var target = &quot;/visuals/livesearch_env/&quot;+env_source_id;
  if(portal_local){
    target += &#039;?portal=&#039;+portal_local;
  }
  var xmlhttp = new XMLHttpRequest();  
  
  
  document.getElementById(&#039;target_select&#039;).value=&#039;.....&#039;;
  document.getElementById(&#039;metadata_select&#039;).value=&#039;.....&#039;;
  document.getElementById(&#039;pname_search_id&#039;).value=&#039;&#039;;
  document.getElementById(&#039;status_pub&#039;).checked=0;
  document.getElementById(&#039;status_priv&#039;).checked=0;
  if(document.getElementById(&#039;portal_select&#039;)){
    document.getElementById(&#039;portal_select&#039;).value =&#039;.....&#039;
  }
  xmlhttp.open(&quot;GET&quot;, target, true);
  xmlhttp.setRequestHeader(&quot;Content-type&quot;,&quot;application/x-www-form-urlencoded&quot;);
  xmlhttp.onreadystatechange=function() {
    if ( xmlhttp.readyState == 4 ) {
      pcount = xmlhttp.responseText;
        if( pcount == 0 ){
            document.getElementById(&#039;nodata_span&#039;).innerHTML=&#039;No Projects Found&#039;;
        }else{
            document.getElementById(&#039;nodata_span&#039;).innerHTML=&#039;&#039;;
        }  
      document.getElementById(&quot;project_count_id&quot;).innerHTML = pcount;
      document.getElementById(&#039;selected_ds_count_id&#039;).innerHTML = 0
      projectTree.deleteChildItems(0);
      projectTree.load(&quot;/visuals/project_dataset_tree_dhtmlx?id=0&quot;,afterCall,&quot;json&quot;); 
    }
  }
  xmlhttp.send();
}
//
// SHOW/FILTER  RESULTS for gene target Search
//
function filter_by_target() {
  var filtering = 1;
  var datasets_local = {};
  var genetarget =   document.getElementById(&#039;target_select&#039;).value;
  var target = &quot;/visuals/livesearch_target/&quot;+genetarget;
  if(portal_local){
    target += &#039;?portal=&#039;+portal_local;
  }
  var xmlhttp = new XMLHttpRequest(); 
  
  document.getElementById(&#039;env_source_select&#039;).value=&#039;.....&#039;;
  document.getElementById(&#039;metadata_select&#039;).value=&#039;.....&#039;;
  document.getElementById(&#039;pname_search_id&#039;).value=&#039;&#039;;
  document.getElementById(&#039;status_pub&#039;).checked=0;
  document.getElementById(&#039;status_priv&#039;).checked=0;
  if(document.getElementById(&#039;portal_select&#039;)){
    document.getElementById(&#039;portal_select&#039;).value =&#039;.....&#039;
  }
  xmlhttp.open(&quot;GET&quot;, target, true);
  xmlhttp.setRequestHeader(&quot;Content-type&quot;,&quot;application/x-www-form-urlencoded&quot;);
  xmlhttp.onreadystatechange=function() {
    if ( xmlhttp.readyState == 4 ) {
       pcount = xmlhttp.responseText;
        if( pcount == 0 ){
            document.getElementById(&#039;nodata_span&#039;).innerHTML=&#039;No Projects Found&#039;;
        }else{
            document.getElementById(&#039;nodata_span&#039;).innerHTML=&#039;&#039;;
        }     
      document.getElementById(&quot;project_count_id&quot;).innerHTML = pcount;
      document.getElementById(&#039;selected_ds_count_id&#039;).innerHTML = 0
      projectTree.deleteChildItems(0);
      projectTree.load(&quot;/visuals/project_dataset_tree_dhtmlx?id=0&quot;,afterCall,&quot;json&quot;);   
    }
  }
  xmlhttp.send();
}
//
// SHOW/FILTER  RESULTS for Portal
//
function filter_by_portal() {
  var filtering = 1;
  var datasets_local = {};
  var portal_id =   document.getElementById(&#039;portal_select&#039;).value;
  var target = &quot;/visuals/livesearch_portal/&quot;+portal_id;
  if(portal_local){
    target += &#039;?portal=&#039;+portal_local;
  }
  var xmlhttp = new XMLHttpRequest(); 
  
  document.getElementById(&#039;env_source_select&#039;).value=&#039;.....&#039;;
  document.getElementById(&#039;metadata_select&#039;).value=&#039;.....&#039;;
  document.getElementById(&#039;pname_search_id&#039;).value=&#039;&#039;;
  document.getElementById(&#039;status_pub&#039;).checked=0;
  document.getElementById(&#039;status_priv&#039;).checked=0;
  document.getElementById(&#039;target_select&#039;).value=&#039;.....&#039;;

  xmlhttp.open(&quot;GET&quot;, target, true);
  xmlhttp.setRequestHeader(&quot;Content-type&quot;,&quot;application/x-www-form-urlencoded&quot;);
  xmlhttp.onreadystatechange=function() {
    if ( xmlhttp.readyState == 4 ) {
       pcount = xmlhttp.responseText;
        if( pcount == 0 ){
            document.getElementById(&#039;nodata_span&#039;).innerHTML=&#039;No Projects Found&#039;;
        }else{
            document.getElementById(&#039;nodata_span&#039;).innerHTML=&#039;&#039;;
        }     
      document.getElementById(&quot;project_count_id&quot;).innerHTML = pcount;
      document.getElementById(&#039;selected_ds_count_id&#039;).innerHTML = 0
      projectTree.deleteChildItems(0);
      projectTree.load(&quot;/visuals/project_dataset_tree_dhtmlx?id=0&quot;,afterCall,&quot;json&quot;);   
    }
  }
  xmlhttp.send();
}
//
// SHOW/FILTER  RESULTS for gene target Search
//
function filter_by_status(pub_status) {
  var filtering = 1;
  var datasets_local = {};
  var target = &quot;/visuals/livesearch_status/&quot;+pub_status;
  if(portal_local){
    target += &#039;?portal=&#039;+portal_local;
  }
  var xmlhttp = new XMLHttpRequest(); 
  
  document.getElementById(&#039;env_source_select&#039;).value=&#039;.....&#039;;
  document.getElementById(&#039;metadata_select&#039;).value=&#039;.....&#039;;
  document.getElementById(&#039;target_select&#039;).value=&#039;.....&#039;;
  document.getElementById(&#039;pname_search_id&#039;).value=&#039;&#039;;
  if(document.getElementById(&#039;portal_select&#039;)){
    document.getElementById(&#039;portal_select&#039;).value =&#039;.....&#039;
  }
  xmlhttp.open(&quot;GET&quot;, target, true);
  xmlhttp.setRequestHeader(&quot;Content-type&quot;,&quot;application/x-www-form-urlencoded&quot;);
  xmlhttp.onreadystatechange=function() {
    if ( xmlhttp.readyState == 4 ) {
       pcount = xmlhttp.responseText;
        if( pcount == 0 ){
            document.getElementById(&#039;nodata_span&#039;).innerHTML=&#039;No Projects Found&#039;;
        }else{
            document.getElementById(&#039;nodata_span&#039;).innerHTML=&#039;&#039;;
        }     
      document.getElementById(&quot;project_count_id&quot;).innerHTML = pcount;
      document.getElementById(&#039;selected_ds_count_id&#039;).innerHTML = 0
      projectTree.deleteChildItems(0);
      projectTree.load(&quot;/visuals/project_dataset_tree_dhtmlx?id=0&quot;,afterCall,&quot;json&quot;);   
    }
  }
  xmlhttp.send();
}

//
// SHOW/FILTER  RESULTS for Metadata Search
//
function filter_by_metadata() {
  var filtering = 1;
  var datasets_local = {};
  var metadata_item =   document.getElementById(&#039;metadata_select&#039;).value;
  var target = &#039;/visuals/livesearch_metadata/&#039;+encodeURIComponent(metadata_item);
  if(portal_local){
    target += &#039;?portal=&#039;+portal_local;
  }
  var xmlhttp = new XMLHttpRequest(); 
  
  document.getElementById(&#039;env_source_select&#039;).value=&#039;.....&#039;;
  document.getElementById(&#039;pname_search_id&#039;).value=&#039;&#039;;
  document.getElementById(&#039;target_select&#039;).value=&#039;.....&#039;;
  document.getElementById(&#039;status_pub&#039;).checked=0;
  document.getElementById(&#039;status_priv&#039;).checked=0;
  if(document.getElementById(&#039;portal_select&#039;)){
    document.getElementById(&#039;portal_select&#039;).value =&#039;.....&#039;
  }
  xmlhttp.open(&quot;GET&quot;, target, true);
  xmlhttp.setRequestHeader(&quot;Content-type&quot;,&quot;application/x-www-form-urlencoded&quot;);
  xmlhttp.onreadystatechange=function() {
    if ( xmlhttp.readyState == 4 ) {
       pcount = xmlhttp.responseText;
        if( pcount == 0 ){
            document.getElementById(&#039;nodata_span&#039;).innerHTML=&#039;No Projects Found&#039;;
        }else{
            document.getElementById(&#039;nodata_span&#039;).innerHTML=&#039;&#039;;
        }     
      document.getElementById(&quot;project_count_id&quot;).innerHTML = pcount;
      document.getElementById(&#039;selected_ds_count_id&#039;).innerHTML = 0
      projectTree.deleteChildItems(0);
      projectTree.load(&quot;/visuals/project_dataset_tree_dhtmlx?id=0&quot;,afterCall,&quot;json&quot;);   
    }
  }
  xmlhttp.send();
}</textarea>
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p>.</p>
  </div>
</footer>

<script type="text/html" id="complexity-popover-template">
  <div class="complexity-notice">
    Complexity : {{ complexity.cyclomatic }} <br>
    Length : {{ complexity.halstead.length }} <br>
    Difficulty : {{ complexity.halstead.difficulty.toFixed(2) }} <br>
    Est # bugs : {{ complexity.halstead.bugs.toFixed(2) }}<br>
  </div>
</script>

<script type="text/javascript" src="../../assets/scripts/bundles/core-bundle.js"></script>
<script type="text/javascript" src="../../assets/scripts/bundles/codemirror.js"></script>
<script type="text/javascript" src="../../assets/scripts/codemirror.markpopovertext.js"></script>
<script type="text/javascript" src="report.js"></script>
<script type="text/javascript" src="report.history.js"></script>
<script type="text/javascript" src="../../assets/scripts/plato-file.js"></script>
</body>
</html>
