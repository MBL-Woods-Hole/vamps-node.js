<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Plato - public/javascripts/user_viz_data.js</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">

  <!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <link href="../../assets/css/vendor/morris.css" rel="stylesheet">
  <link href="../../assets/css/vendor/bootstrap.css" rel="stylesheet">
  <link href="../../assets/css/vendor/font-awesome.css" rel="stylesheet">
  <link href="../../assets/css/vendor/codemirror.css" rel="stylesheet">
  <link href="../../assets/css/plato.css" rel="stylesheet">
  <link href="../../assets/css/plato-file.css" rel="stylesheet">

</head>

<body>

<div class="navbar navbar-fixed-top">
  <div class="container">
    <a class="navbar-brand" href="http://github.com/es-analysis/plato">Plato on Github</a>
    <ul class="nav navbar-nav">
      <li>
        <a href="../../index.html">Report Home</a>
      </li>
    </ul>
  </div>
</div>

<div class="jumbotron">
  <div class="container">
    <h1>public/javascripts/user_viz_data.js</h1>
  </div>
</div>

<div class="container aggregate-stats">
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Maintainability <a href="http://blogs.msdn.com/b/codeanalysis/archive/2007/11/20/maintainability-index-range-and-meaning.aspx"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="A value between 0 and 100 that represents the relative ease of maintaining the code. A high value means better maintainability." data-original-title="Maintainability Index"  data-container="body"></i></a></h2>
      <p class="stat">57.44</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Lines of code <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h2>
      <p class="stat">182</p>
    </div>
  </div>
  <div class="row historical">
    <div class="col-md-6">
      <p id="chart_historical_maint" class="chart"></p>
    </div>
    <div class="col-md-6">
      <p id="chart_historical_sloc" class="chart"></p>
    </div>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Difficulty  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="The difficulty measure is related to the difficulty of the program to write or understand." data-original-title="Difficulty" data-container="body"></i></a></h2>
      <p class="stat">27.84</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Estimated Errors  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Halstead's delivered bugs is an estimate for the number of errors in the implementation." data-original-title="Delivered Bugs" data-container="body"></i></a></h2>
      <p class="stat">1.21</p>
    </div>
  </div>
</div>

<div class="container charts">
  <div class="row">
    <h2 class="header">Function weight</h2>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h3 class="chart-header">By Complexity <a href="http://en.wikipedia.org/wiki/Cyclomatic_complexity"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="This metric counts the number of distinct paths through a block of code. Lower values are better." data-original-title="Cyclomatic Complexity" data-container="body"></i></a></h3>
      <div id="fn-by-complexity" class="stat"></div>
    </div>
    <div class="col-md-6">
      <h3 class="chart-header">By SLOC  <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h3>
      <div id="fn-by-sloc" class="stat"></div>
    </div>
  </div>
</div>

<div class="container">
  <div class="row">
    <textarea id="file-source" class="col-md-12">//
//  CREATE SINGLE BARCHART on page load
//
var $liveTip = $(&#039;&lt;div id=&quot;livetip_chart&quot;&gt;&lt;/div&gt;&#039;).hide().appendTo(&#039;body&#039;),
    $win = $(window),
    showTip;

var tip = {
  title: &#039;&#039;,
  offset: 12,
  delay: 50,
  position: function(event) {
    var positions = {x: event.pageX, y: event.pageY};
    var dimensions = {
      x: [
        $win.width(),
        $liveTip.outerWidth()
      ],
      y: [
        $win.scrollTop() + $win.height(),
        $liveTip.outerHeight()
      ]
    };
 
    for ( var axis in dimensions ) {
 
      if (dimensions[axis][0] &lt;dimensions[axis][1] + positions[axis] + this.offset) {
        positions[axis] -= dimensions[axis][1] + this.offset;
      } else {
        positions[axis] += this.offset;
      }
 
    }
 
    $liveTip.css({
      top: positions.y,
      left: positions.x
    });
  }
};
$(&quot;body&quot;).delegate(&quot;.tooltip_user&quot;, &quot;mouseover mouseout mousemove&quot;, function (event) {
      var link = this,
      html = &#039;&#039;;
      $link = $(this);
     
      if (event.type == &#039;mouseover&#039;) {
        tip.id = link.id;
		//alert(tip.id)
        link.id = &#039;&#039;;
        id_items = tip.id.split(&#039;-|-&#039;);
        html = &quot;&lt;table&gt;&lt;tr&gt;&quot;;
        if(id_items[0] == &#039;dheatmap&#039;) {
          html += &quot;&lt;td&gt;&quot;+id_items[1]+&quot;&lt;/td&gt;&quot;;
          html += &quot;&lt;/tr&gt;&lt;tr&gt;&quot;;
          html += &quot;&lt;td&gt;&quot;+id_items[2]+&quot;&lt;/td&gt;&quot;;
          html += &quot;&lt;/tr&gt;&lt;tr&gt;&quot;;
          html += &quot;&lt;td&gt;Distance: &quot;+id_items[3]+&quot;&lt;/td&gt;&quot;;
        }else if(id_items[0] == &#039;frequencies&#039;){
          html += &quot;&lt;td&gt;&quot;+id_items[1]+&quot;&lt;/td&gt;&quot;;
          html += &quot;&lt;/tr&gt;&lt;tr&gt;&quot;;
          html += &quot;&lt;td&gt;&quot;+id_items[2]+&quot;&lt;/td&gt;&quot;;
          html += &quot;&lt;/tr&gt;&lt;tr&gt;&quot;;
          html += &quot;&lt;td&gt;Count: &quot;+id_items[3]+&quot; (&quot;+id_items[4]+&quot;%)&lt;/td&gt;&quot;;
        }else{  // barcharts and piecharts            
          html += &quot;&lt;td&gt;&quot;+id_items[1]+&quot;&lt;/td&gt;&quot;;
          html += &quot;&lt;/tr&gt;&lt;tr&gt;&quot;;
          html += &quot;&lt;td&gt;Count: &quot;+id_items[2]+&quot; (&quot;+id_items[3]+&quot;%)&lt;/td&gt;&quot;;
        }
        html += &quot;&lt;/tr&gt;&lt;table&gt;&quot;;

        showTip = setTimeout(function() {
     
          $link.data(&#039;tipActive&#039;, true);
          
          tip.position(event);
     //alert(event.pageX)
          $liveTip
          .html(&#039;&lt;div&gt;&#039; + html  + &#039;&lt;/div&gt;&#039;)
          .fadeOut(0)
          .fadeIn(200);
     
        }, tip.delay);
      }
     
      if (event.type == &#039;mouseout&#039;) {
        link.id = tip.id || link.id;
        if ($link.data(&#039;tipActive&#039;)) {
          $link.removeData(&#039;tipActive&#039;);
          $liveTip.hide();
        } else {
          clearTimeout(showTip);
        }
      }
     
      if (event.type == &#039;mousemove&#039; &amp;&amp; $link.data(&#039;tipActive&#039;)) {
        tip.position(event);
      }
              
});              

$(document).ready(function() {  

	create_barcharts(&#039;single&#039;);
	barcharts_table_div.innerHTML = get_single_bar_html(mtx_local);
        //var info_line = create_header(&#039;bars&#039;, pi_local);
// 		var barcharts_div = document.getElementById(&#039;barcharts_div&#039;);
// 		barcharts_div.style.display = &#039;block&#039;;
//         
//         //document.getElementById(&#039;pre_barcharts_table_div&#039;).style.display = &#039;block&#039;;
// 
// 
//         data = [];
//         // for (var p in mtx_local.columns){
//            tmp={};
//            tmp.datasetName = mtx_local.dataset;
// 		   //tmp.alltotal = mtx_local.total
//            for (var t in mtx_local.rows){
//              tmp[mtx_local.rows[t]] = mtx_local.data[t];
//            }
//            data.push(tmp);
//          
// 
//       
//         var unit_list = mtx_local.rows;
//        
//         // for (var o in mtx_local.rows){
//       //     unit_list.push(mtx_local.rows[o].name);
//       //   }
//         
// 
//         var ds_count = 1;      
//         var bar_height = 20;
//         var props = get_image_properties(bar_height, ds_count); 
//         //console.log(props)
//         var color = d3.scale.ordinal()                  
//           .range( get_colors(unit_list) );
// 
//         color.domain(d3.keys(data[0]).filter(function(key) { return key !== &quot;datasetName&quot;; }));
// 
//         
// 
//         data.forEach(function(d) {
//           var x0 = 0;
//           d.unitObj = color.domain().map(function(name) { 
//             return { name: name, x0: x0, x1: x0 += +d[name] }; 
//           });
//           
//           d.total = d.unitObj[d.unitObj.length - 1].x1;
//           //console.log(d.total);
//         });
// 
// 
//         data.forEach(function(d) {
//           // normalize to 100%
//           tot = d.total;
//           d.unitObj.forEach(function(o) {
//               //console.log(o);
//               o.x0 = (o.x0*100)/tot;
//               o.x1 = (o.x1*100)/tot;
//           });
//         });
//       
//         
//         create_svg_object(props, color, data, ts);
        
})


function get_single_bar_html(obj){
	
	var html =&#039;&#039;;
	html += &quot;&lt;div class=&#039;overflow_500&#039;&gt;&quot;;
	html += &quot;&lt;table class=&#039;table table-condensed overflow200&#039;&gt;&quot;;
	html += &#039;&lt;tr&gt;&lt;td width=&quot;25&quot;&gt;color&lt;/td&gt;&lt;td&gt;Taxonomy&lt;/td&gt;&lt;td&gt;Count&lt;/td&gt;&lt;/tr&gt;&#039;;
	for(n in obj.rows){
		if(obj.data[n] &gt; 0){
			color = string_to_color_code(obj.rows[n].id)
			link = &#039;sequences?id=&#039;+obj.columns[0].id+&#039;&amp;taxa=&#039;+encodeURIComponent(obj.rows[n].id);
			html += &quot;&lt;tr&gt;&lt;td style=&#039;background-color:&quot;+color+&quot;&#039;&gt;&lt;/td&gt;&lt;td&gt;&lt;a href=&#039;&quot;+link+&quot;&#039;&gt;&quot;+obj.rows[n].id+&#039;&lt;/a&gt;&lt;/td&gt;&lt;td&gt;&#039;+obj.data[n]+&#039;&lt;/td&gt;&lt;/tr&gt;&#039;;
		}
	}
	html += &#039;&lt;/table&gt;&lt;/div&gt;&#039;;
	
	return html;
}
//
//
//
// function create_svg_object(props, color, data, ts) {
//        //d3.select(&#039;svg&#039;).remove();
//       
//       var svg = d3.select(&quot;#barcharts_div&quot;).append(&quot;svg&quot;)
//                   .attr(&quot;width&quot;,  props.width)
//                   .attr(&quot;height&quot;, props.height)
//                 .append(&quot;g&quot;)
//                   .attr(&quot;transform&quot;, &quot;translate(&quot; + props.margin.left + &quot;,&quot; + props.margin.top + &quot;)&quot;);
//       
//       
//       // axis legends -- would like to rotate dataset names
//       props.y.domain(data.map(function(d) { return d.datasetName; }));
//       props.x.domain([0, 100]);
// 
// 
//        var datasetBar = svg.selectAll(&quot;.bar&quot;)
//           .data(data)
//         .enter() .append(&quot;g&quot;)
//           .attr(&quot;class&quot;, &quot;g&quot;)
//           .attr(&quot;transform&quot;, function(d) { return  &quot;translate(0, &quot; + props.y(d.datasetName) + &quot;)&quot;; })  
// 	 
// 
//        var gnodes = datasetBar.selectAll(&quot;rect&quot;)
//            .data(function(d) { return d.unitObj; })
//            .enter()
//              .append(&#039;a&#039;).attr(&quot;xlink:href&quot;,  function(d) { 
// 			     return &#039;sequences?taxa=&#039;+encodeURIComponent(d.name)+&#039;&amp;did=&#039;+mtx_local.did;
// 			  }).style(&quot;fill&quot;,   function(d) { return color(d.name); });
//           
//        gnodes.append(&quot;rect&quot;)
//              .attr(&quot;x&quot;, function(d) { return props.x(d.x0); })
//              .attr(&quot;y&quot;, 15)  // adjust where first bar starts on x-axis
//              .attr(&quot;width&quot;, function(d) { return props.x(d.x1) - props.x(d.x0); })
//              .attr(&quot;height&quot;,  25)
// 		     
//              .attr(&quot;id&quot;,function(d,i) { 
//                 var cnt =  mtx_local.data[i];
//                 var total = mtx_local.total;
//                 var pct = (cnt * 100 / total).toFixed(2);
//                 var id = &#039;barcharts-|-&#039; + d.name + &#039;-|-&#039;+ cnt.toString() + &#039;-|-&#039; + pct;
//                 return id;    // ip of each rectangle should be datasetname-|-unitname-|-count
//               }) 
// 			  .attr(&quot;class&quot;,&quot;tooltipx&quot;);
// 
// 
// }

// function get_image_properties(bar_height, ds_count) {
//   var props = {};
//   
//   //props.margin = {top: 20, right: 20, bottom: 300, left: 50};
//   props.margin = {top: 20, right: 0, bottom: 20, left: 0};
//   
//   var plot_width = 900;
//   var gap = 2;  // gap on each side of bar
//   props.width = plot_width + props.margin.left + props.margin.right;
//   props.height = (ds_count * (bar_height + 2 * gap)) + 125;
//   
//   props.x = d3.scale.linear() .rangeRound([0, plot_width]);
//     
//   props.y = d3.scale.ordinal()
//       .rangeBands([0, (bar_height + 2 * gap) * ds_count]);
//     
//   props.xAxis = d3.svg.axis()
//           .scale(props.x)
//           .orient(&quot;top&quot;);
//   
//   props.yAxis = d3.svg.axis()
//           .scale(props.y)
//           .orient(&quot;left&quot;);
//           
//               
//   return props;
// }</textarea>
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p>.</p>
  </div>
</footer>

<script type="text/html" id="complexity-popover-template">
  <div class="complexity-notice">
    Complexity : {{ complexity.cyclomatic }} <br>
    Length : {{ complexity.halstead.length }} <br>
    Difficulty : {{ complexity.halstead.difficulty.toFixed(2) }} <br>
    Est # bugs : {{ complexity.halstead.bugs.toFixed(2) }}<br>
  </div>
</script>

<script type="text/javascript" src="../../assets/scripts/bundles/core-bundle.js"></script>
<script type="text/javascript" src="../../assets/scripts/bundles/codemirror.js"></script>
<script type="text/javascript" src="../../assets/scripts/codemirror.markpopovertext.js"></script>
<script type="text/javascript" src="report.js"></script>
<script type="text/javascript" src="report.history.js"></script>
<script type="text/javascript" src="../../assets/scripts/plato-file.js"></script>
</body>
</html>
