<!DOCTYPE html>
<html lang="en">
<head>
  <title><%= title %></title>
  
  <link rel="stylesheet" type="text/css" href="/stylesheets/style.css">
  <link rel="stylesheet" type="text/css" href="/stylesheets/visualization.css"> 
  <link rel="stylesheet" type="text/css" href="/stylesheets/bootstrap.min.css" >
  <link rel="stylesheet" type="text/css" href="/stylesheets/bootstrap-theme.min.css">
  <link rel="stylesheet" type="text/css" href="/stylesheets/../DataTables/datatables.min.css"/>


   <style type="text/css">
     body {
       padding-top: 60px;
       padding-bottom: 40px;
     }
   </style>
  <link href="/stylesheets/bootstrap-responsive.css" rel="stylesheet" \>

</head>
<body>
    <!-- Fixed navbar at top -->
      <% include ../add_ins/nav-bar.html %>
    <!-- Fixed navbar at top -->
  
  <div class="container-fluid">       <!-- ends in end.ejs -->
    <div class="row-fluid">             <!-- ends in end.ejs -->
     <div class="col-lg-12" id="">        <!-- ends in end.ejs -->


<br>
 <div class='title'>Metadata</div>
 <div class='subtitle'></div>

<% if (all_metadata) { %>
<%
} else {
  var all_metadata = {}
} %>

<% if(messages.success){ %>
  <div class="alert_flash_message_success" ><%- messages.success %> </div>
<% }else if(messages.fail){ %>
<% var myArray = messages.fail %>
<div class="alert_flash_message_fail" >
  <ul>
  <% myArray.forEach(function(value){ %>
    <li>
      <%= value %>
    </li>
  <% }) %>
  </ul>
</div>
<% }%>
<br>


<H3>Instructions:</H3>
<ol>
<li>
 Fields in yellow are mandatory; other unknown entries may be left blank.
</li>
<li>
 The parameter names listed below are from the MIGS/MIMS/MIMARKS project of the  Genomic Standards Consortium.
</li>
<li class="message">
 A range is not permitted for any value.
</li>
</ol>

<div class="dataTables_wrapper">
    <table id="example" class="stripe row-border order-column" cellspacing="0" width="100%">
    <thead>
      <!-- rowspan="1" colspan="3" -->
      <tr>
      <th> r1-c1</th>
      <th> r1-c2</th>
    </tr>
    </thead>
    <tbody>
      <tr>
      <td> r2-c1</td>
      <td> r2-c2</td>
      </tr>
      <tr>
      <td> r3-c1</td>
      <td> r3-c2</td>
      <td> r3-c3</td>
      <td> r3-c4</td>
      <td> r3-c5</td>
      <td> r3-c6</td>
      <td> r3-c7</td>
      <td> r3-c8</td>
      <td> r3-c9</td>
      <td> r3-c10</td>
      <td> r3-c11</td>
      <td> r3-c12</td>
      <td> r3-c13</td>
      <td> r3-c14</td>
      <td> r3-c15</td>
      <td> r3-c16</td>
      <td> r3-c17</td>
      <td> r3-c18</td>
      <td> r3-c19</td>
      </tr>
    </tbody>
</div>

<form name='add_project_form' method='POST' action='/metadata/metadata_upload'>
<!-- <form action="" method="post" enctype="multipart/form-data"> -->
  <fieldset id="general" class="required_fields" >
  <legend id="general-legend">General sample description</legend>
  <% if (all_metadata) { %>
    <% for (var pid in all_metadata) { %>
      <!-- dataset_id project title username email institution first_name last_name public -->

      <label for="project_title">Title of Project:</label>
      <input type="text" id="project_title" name="project_title" value='<%= all_metadata[pid].title %>'/>

      <br />
      <label for="project_name">VAMPS project name (MBL Supplied)</label>
      <input type="text" id="project_name" readonly name="project_name" placeholder="DCO_GAI_Bv3v5" value='<%= all_metadata[pid].project %>'/>

      <br />
      <label for="pi_name">PI Name:</label>
      <input type="text" id="pi_name" name="pi_name"  value='<%= all_metadata.pi_name %>'/>

      <% for (var did in all_metadata[pid]["dataset_id"]) { %>
        <input type='hidden' name='dataset_id' value='<%= all_metadata[pid]["dataset_id"][did] %>' />
      <% } %>

    <% } %>
  <%
  } else { var all_metadata = {} %>
    <!--<input type="text" id="project_name" readonly name="project_name" placeholder="DCO_GAI_Bv3v5"/>-->
  <%}%>
  <br />
  <label for="pi_email">PI's email address:</label>
  <input type="email" id="pi_email" name="pi_email"  value='<%= all_metadata.pi_email %>'/>
  <br />
  <label for="project_abstract">CoDL project abstract (.doc format):</label>
  <textarea id="project_abstract" name="project_abstract"  placeholder= '<%= all_metadata.project_abstract %>'></textarea>
  <br />
  <label for="references">References for selected manuscripts published that describe the location:</label>
  <textarea id="references" name="references"  placeholder='<%= all_metadata.references %>'></textarea>
  <br />
  </fieldset>
  <fieldset id="parameters">
    <legend id="parameters-legend">Table of metadata parameters</legend>
    <!--cellpadding="1" cellspacing="1" border="1" -->
    <!-- <table class='table table-condensed' id="example"> -->

      <table id="example" class="stripe row-border order-column" cellspacing="0" width="100%">
      <thead>
        <!-- rowspan="1" colspan="3" -->
      </thead>
      <tbody>
    <% if (all_metadata) { %>
      <!-- all_metadata -->
      <!-- for each project  -->
      <% for (var key in all_metadata) { %>
        <% if (all_field_names) { %>
          <!-- for each field name  -->
          <% for (var idx in all_field_names) {
              field_name = all_field_names[idx][0]
          %>
          <tr>
<!--first column  -->
            <% include first_column.ejs %>
<!-- second column: MBL or user supplied -->
            <td><%= all_field_names[idx][2] %></td>
<!-- third column (value) -->
            <!-- make a cell for each dataset_id -->
            <% for (var did in all_metadata[pid]["dataset_id"]) { %>
              <% include third_column.ejs %>
              <% } %> <!-- for (var did in all_metadata[pid]["dataset_id"])  -->

        </tr>
          <% } %> <!-- for (var idx in all_field_names)  -->
        <% } %> <!-- if (all_field_names) -->
        <% } %> <!-- for (var pid in all_metadata) -->
        <%
            } // end: if (all_metadata)
             else {
              var all_metadata = {}
        } %>
  </table>
  </fieldset>
<br>

<!-- center -->
<input type='hidden' name='project_id' value='<%= pid %>' />
<input type='hidden' name='from_where' value='metadata_upload_from_file' />

<button class='btn btn-sm btn-primary' type='submit'>Submit</button>

</form>


<% include ../add_ins/end.ejs %>
<script type='text/javascript' src='/javascripts/global.js'></script>
<script type='text/javascript' src='/javascripts/bootstrap-select.js'></script>
<script type='text/javascript' src='/javascripts/metadata.js'></script>
<script type="text/javascript" src="/javascripts/../DataTables/datatables.min.js"></script>

</script>
</body>
</html>