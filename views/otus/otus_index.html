<% menu_section='VISUALS' %>
<% include ../add_ins/begin.ejs %>
<% var info = JSON.parse(proj_info) %>
<% var env_sources = JSON.parse(md_env_package) %>
<% var targets = JSON.parse(constants).TARGETS %>
<% var portals = JSON.parse(constants).PORTALS %>
<% if(filtering == undefined){ %>
<%  filtering = 0 %>
<% } %>
<script>
  var datasets_local  = JSON.parse('<%- data_to_open %>');
  var portal_local  = "<%= portal_to_show %>";
  var env_sources_local  = JSON.parse('<%- md_env_package %>');
</script>

<link rel="stylesheet" href="/stylesheets/dhtmlx/dhtmlxtree.css" >

<div class='title ' id='' >OTU Selection</div>


<% if (messages.success) { %>
  	<div class="alert_flash_message_success"><%= messages.success %></div>
<% }else if(messages.fail){ %>
    <div class="alert_flash_message_fail"><%= messages.fail %></div>
<% } %>

      <table class='table' border='1'>
      <tr>

        <td>
           <a  id='clear_filters_btn_id' type='button' value='' class='btn btn-xs btn-primary' >Clear Filters/Reset Projects</a>
        </td>

        <td>
          
          <strong>Select OTU Set Below:</strong></div>
        </td>

        <td>

            
        </td>

      </tr>
      <tr>

        <td style='width:100px;'>
          <% include ../add_ins/otu_filters.html %>
        </td>

        <td>
            <div id='otus_select_div' style='height:500px;overflow:auto;'>
              <span id='nodata_span' style='visiblity:hidden'>Loading Project List</span>
            </div>
        </td>

		<td class='td_top' width="30%">
          <div class='clean_list'>
            <li><button type="button" class="btn btn-sm btn-warning" name='Next' id="selection_btn_visuals">
                &nbsp;Visualizations&nbsp;&nbsp;&nbsp;&nbsp;
                <span class="glyphicon glyphicon-circle-arrow-right" aria-hidden="true"></span>
                </button>
                - Select how you want to view data.
            </li>
            <br>
            <li>
                <% if(user.username == 'guest'){ %>
                    <button type="button" disabled class="btn btn-sm btn-primary" name='Next' id="selection_btn_exports">
                    &nbsp;Download Data&nbsp;
                    <span class="glyphicon glyphicon-circle-arrow-right" aria-hidden="true"></span>
                    </button>
                <% }else{ %>
                    <button type="button" class="btn btn-sm btn-primary" name='Next' id="selection_btn_exports">
                    &nbsp;Download Data&nbsp;
                    <span class="glyphicon glyphicon-circle-arrow-right" aria-hidden="true"></span>
                    </button>
                <% } %>
                - Download count matrix data.
            </li>
           
          </div>
		</td>

      </tr>
      </table>



<% include ../add_ins/end.ejs %>

<script type="text/javascript" src="/javascripts/global.js"></script>
<!-- <script type="text/javascript" src="/javascripts/dhtmlx/dhtmlxtree.js" ></script> -->
<!-- <script type="text/javascript" src="/javascripts/load_otu_project_tree.js"></script> -->
<script type="text/javascript" src="/javascripts/otus.js"></script>
<!-- <script type="text/javascript" src="/javascripts/check_form_pg1.js"></script> -->
<!-- <script type="text/javascript" src="/javascripts/project_dataset_tree.js"></script> -->

<script>

    // code for tooltips
    var $liveTip_pjds = $('<div id="livetip_pjds"></div>').hide().appendTo('body'),
        $win = $(window),
        showTip;

    var tip = {
      title: '',
      offset: 12,
      //delay: 300,
      position: function(event) {
        var positions = {x: event.pageX, y: event.pageY};
        var dimensions = {
          x: [
            $win.width(),
            $liveTip_pjds.outerWidth()
          ],
          y: [
            $win.scrollTop() + $win.height(),
            $liveTip_pjds.outerHeight()
          ]
        };

        for ( var axis in dimensions ) {
          if (dimensions[axis][0] <dimensions[axis][1] + positions[axis] + this.offset) {
            positions[axis] -= dimensions[axis][1] + this.offset;
          } else {
            positions[axis] += this.offset;
          }
        }
        $liveTip_pjds.css({
          top: positions.y,
          left: positions.x
        });

      }
    };


   
</script>
<script>
var $, clear_filters, initialize_dhtmlx_otu_tree
$(document).ready(function () {
  // show_dataset_tree = true;
  load_otu_list()
  //clear_filters()
  
})
</script>


<!-- <script type="text/javascript" src="/javascripts/visuals_index.js"></script> -->
 </body>
 </html>
