<% include ../add_ins/begin.ejs %>

<% s = JSON.parse(searches) %>
<% f = JSON.parse(filtered) %>
<script>
  
</script>
<div class='title'>Search Result</div>
<div class='subtitle'>Metadata</div>
<table border='1' class='small_font'><tr><td>
Search-1
<% for(i in s.search1) { %>
	<% if(i !== 'ds_plus' && i !== 'datasets') { %>
		<br><%= i %>: <%= s.search1[i] %>
	<% } %>
<% } %>
</td>
<td>
Search-2
<% if('search2' in s) { %>
	<% for(i in s.search2) { %>
		<% if(i !== 'ds_plus' && i !== 'datasets') { %>
			<br><%= i %>: <%= s.search2[i] %>
		<% } %>
	<% } %>
<% }else{ %>
		<br>Empty
<% } %>
</td>
<td>
Search-3
<% if('search3' in s) { %>
	<% for(i in s.search3) { %>
		<% if(i !== 'ds_plus' && i !== 'datasets') { %>		
			<br><%= i %>: <%= s.search3[i] %>
		<% } %>
	<% } %>
<% }else{ %>
		<br>Empty
<% } %>
</td>
</tr>
<tr>
	<td>



<% if(s.search1.datasets.length == 0){ %>
		<b>no data found</b>
<% }else{ %>
		<form id='' name='' method='POST' action='/visuals/unit_selection'>
			<div class='search_ds_result_box'>
			<% for(i in s.search1.ds_plus) { %>
				<li>
					<%= parseInt(i)+1 %>) <%= s.search1.ds_plus[i].pname %>--<%= s.search1.ds_plus[i].dname %>
					<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(value: <%= s.search1.ds_plus[i].value %>)
				</li>
			<% } %>
			
			</div>
			
			<input type='submit' name='' value='Use These Datasets' >
			<input type='hidden' name='search' value='1' >
			<input type='hidden' name='dataset_ids' value='<%= JSON.stringify(s.search1.datasets) %>' >
		</form>
<% } %>
</td>
<td>
	<% if('search2' in s) { %>
		<% if(s.search2.datasets.length == 0){ %>
			<b>no data found</b>
		<% }else{ %>
			<form id='' name='' method='POST' action='/visuals/unit_selection'>
				<div class='search_ds_result_box'>
				<% for(i in s.search2.ds_plus) { %>
					<li>
						<%= parseInt(i)+1 %>) <%= s.search2.ds_plus[i].pname %>--<%= s.search2.ds_plus[i].dname %>
					<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(val: <%= s.search2.ds_plus[i].value %>)
					</li>
				<% } %>

				</div>
				
				<input type='submit' name='' value='Use These Datasets' >
			<input type='hidden' name='search' value='1' >
			<input type='hidden' name='dataset_ids' value='<%= JSON.stringify(s.search2.datasets) %>' >
			</form>
		<% } %>
	<% } %>
</td>
<td>
	<% if('search3' in s) { %>
		<% if(s.search3.datasets.length == 0){ %>
			<b>no data found</b>
		<% }else{ %>
			<form id='' name='' method='POST' action='/visuals/unit_selection'>
				<div class='search_ds_result_box'>
				<% for(i in s.search3.ds_plus) { %>
					<li>
						<%= parseInt(i)+1 %>) <%= s.search3.ds_plus[i].pname %>--<%= s.search3.ds_plus[i].dname %>
					<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(val: <%= s.search3.ds_plus[i].value %>)
					</li>
				<% } %>
			
				</div>
				
				<input type='submit' name='' value='Use These Datasets' >
				<input type='hidden' name='search' value='1' >
				<input type='hidden' name='dataset_ids' value='<%= JSON.stringify(s.search3.datasets) %>' >
			</form>
		<% } %>
	<% } %>

</td>
</tr>
<tr>
<td  colspan='3'><center>
	<% if(!('search2' in s) && !('search3' in s)) { %>
		<br><strong><%= f.datasets.length %> datasets</strong>
	<% }else{ %>	
		<br><strong>Combined by <%= join_type %> (<%= f.datasets.length %> datasets)</strong>

	<% } %>
	<% if(f.datasets.length == 0){ %>
			<b>no data found</b>
		<% }else{ %>
			<form id='' name='' method='POST' action='/visuals/unit_selection'>
				<div class='search_ds_result_box'>
				<% for(i in f.ds_plus) { %>
					<li>
						<%= parseInt(i)+1 %>) <%= f.ds_plus[i].pname %>--<%= f.ds_plus[i].dname %>
					</li>
				<% } %>
			
				</div>
				
				<input type='submit' name='' value='Use These Datasets' >
				<input type='hidden' name='search' value='1' >
				<input type='hidden' name='dataset_ids' value='<%= JSON.stringify(f.datasets) %>' >
			</form>
		<% } %>
	</center>
</td></tr></table>
<% include ../add_ins/end.ejs %>

